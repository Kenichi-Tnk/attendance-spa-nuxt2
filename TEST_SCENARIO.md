# 修正申請機能のテストシナリオ

## 環境準備

```bash
# フロントエンド起動
npm run dev

# バックエンド起動（別ターミナル）
cd attendance-api
php artisan serve
```

## テストケース

### ケース 1: 通常の修正申請（承認待ちなし）

1. `/correction-requests/new` にアクセス
2. 対象日を選択（承認待ちの申請がない日付）
3. **期待される動作:**

   - 現在の勤怠データが表示される
   - フォームに勤怠データが自動入力される
   - 「申請する」ボタンが表示される
   - 承認待ちアラートは表示されない

4. 時刻を修正して「申請する」をクリック
5. **期待される動作:**
   - 申請成功メッセージが表示される
   - フォームの時刻・理由・休憩時間がクリアされる
   - 3 秒後に申請一覧へリダイレクト

### ケース 2: 承認待ちの日付を選択

1. まず上記ケース 1 で申請を作成（status: pending）
2. 再度 `/correction-requests/new` にアクセス
3. 同じ日付を選択
4. **期待される動作:**
   - ⚠️ 黄色い承認待ちアラートが表示される
   - アラート内容:
     - 「承認待ちの申請があります」タイトル
     - 説明文
     - 申請 ID・申請日時
     - 「申請内容を確認」ボタン
     - 「申請一覧へ戻る」ボタン
   - フォームの入力フィールドが全てクリアされる
   - 「申請する」ボタンが非表示
   - フォームは入力可能（disabled ではない）だが送信不可

### ケース 3: 承認待ち → 別の日付を選択

1. 承認待ちの日付を選択（ケース 2 の状態）
2. 別の日付（承認待ちなし）に変更
3. **期待される動作:**
   - 承認待ちアラートが消える
   - 新しい日付の勤怠データが表示される
   - フォームに自動入力される
   - 「申請する」ボタンが表示される

### ケース 4: 申請後に同じ日付を再選択

1. 申請を送信（ケース 1）
2. リダイレクト前に、同じ日付を再度選択
3. **期待される動作:**
   - 承認待ちアラートが表示される
   - フォームがクリアされる
   - 「申請する」ボタンが非表示

### ケース 5: デバッグ機能（開発環境のみ）

1. 開発環境で `/correction-requests/new` にアクセス
2. **期待される動作:**
   - フォーム下部に「デバッグ情報」ボタンが表示される
3. 日付を選択してデバッグボタンをクリック
4. **期待される動作:**
   - アラートダイアログが表示される
   - フォームの状態が確認できる
   - コンソールに詳細情報が出力される

## 確認ポイント

### UI/UX

- [ ] 承認待ちアラートが目立つ（黄色背景）
- [ ] アニメーション効果が動作
- [ ] ボタンの表示/非表示が適切
- [ ] フォームのクリア処理が正常

### データ整合性

- [ ] 承認待ち状態が正しく検出される
- [ ] 日付変更時にデータが正しく更新される
- [ ] 申請後の pendingRequest 状態が正しい

### コンソールログ

- [ ] 「日付変更: xxx → yyy」が表示される
- [ ] 「取得した修正申請データ」が表示される
- [ ] 「申請中のリクエスト」が表示される
- [ ] エラーが発生していない

## 既知の問題・注意点

1. Toast 通知が未実装の場合、成功メッセージが表示されない
   → `npm install @nuxtjs/toast` で解決

2. API のレスポンス形式がドキュメントと異なる場合
   → コンソールログで確認してコード調整

3. タイムゾーンの違いによる日付比較エラー
   → 全て YYYY-MM-DD 形式で比較しているため問題なし
